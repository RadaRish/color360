# Инструкция по установке Color360 на хостинг reg.ru

Это руководство объясняет, как развернуть сайт Color360 и приложение для редактирования панорам на хостинге reg.ru.

## Обзор развертывания

reg.ru предлагает несколько типов хостинга. Для полноценной работы Color360 с Node.js бэкендом рекомендуется использовать VPS/VDS или выделенный сервер. Для статического редактора панорам можно использовать обычный веб-хостинг.

## Вариант 1: Развертывание на VPS/VDS (рекомендуется)

### 1. Закажите VPS на reg.ru

1. Перейдите на сайт reg.ru
2. Выберите "VPS/VDS" в разделе хостинга
3. Выберите тариф с поддержкой:
   - Ubuntu 20.04 или выше
   - Минимум 2 ГБ RAM и 20 ГБ диска
   - Root-доступ

### 2. Подготовьте сервер

После получения доступов к VPS:

```bash
# Подключитесь к серверу по SSH
ssh root@ваш_ip_адрес

# Обновите систему
apt update && apt upgrade -y

# Установите необходимые пакеты
apt install docker.io docker-compose git nginx certbot python3-certbot-nginx -y

# Запустите Docker
systemctl start docker
systemctl enable docker
```

### 3. Разверните приложение

```bash
# Создайте директорию для приложения
mkdir -p /opt/color360
cd /opt/color360

# Клонируйте репозиторий (или загрузите файлы другим способом)
git clone https://ваш_репозиторий.git .

# Создайте необходимые директории
mkdir -p data ssl logs

# Запустите приложение
docker-compose up -d --build
```

### 4. Настройте домен

1. В панели управления reg.ru добавьте A-запись для вашего домена, указывающую на IP вашего VPS
2. В панели управления reg.ru настройте SSL-сертификат или используйте Let's Encrypt:

```bash
# Получите бесплатный SSL-сертификат от Let's Encrypt
certbot --nginx -d ваш_домен.ru
```

## Вариант 2: Развертывание на обычном хостинге

Если вы используете обычный хостинг reg.ru без поддержки Docker:

### 1. Подготовка файлов

1. Соберите статические файлы редактора панорам локально:
   ```bash
   cd pano
   npm install
   npm run build
   ```

2. Подготовьте основной сайт для статического хостинга (ограничения по функциональности)

### 2. Загрузка файлов

1. В панели управления reg.ru создайте новый сайт
2. Загрузите файлы через файловый менеджер или FTP:
   - Основной сайт в корневую директорию
   - Редактор панорам в поддиректорию `/pano`

### 3. Настройка Node.js приложения (если поддерживается)

Если ваш тариф хостинга reg.ru поддерживает Node.js:

1. Загрузите файлы приложения
2. В панели управления настройте запуск Node.js приложения:
   - Укажите главный файл: `server.js`
   - Установите необходимые зависимости: `npm install`
   - Настройте порт и переменные окружения

## Вариант 3: Использование облачных сервисов reg.ru

reg.ru также предлагает облачные сервисы, которые можно использовать:

### 1. REG.RU Cloud VDS

1. Закажите Cloud VDS
2. Следуйте инструкции для VPS/VDS выше

### 2. REG.RU Docker Hosting (если доступен)

Если reg.ru предлагает Docker хостинг:
1. Загрузите docker-compose.yml файл
2. Настройте переменные окружения
3. Запустите контейнеры через панель управления

## Настройка домена и SSL

### 1. Добавление домена

1. В панели управления reg.ru перейдите в раздел "Домены"
2. Добавьте ваш домен или используйте поддомен
3. Настройте DNS-записи:
   - A-запись для основного домена
   - CNAME-записи для поддоменов (если необходимо)

### 2. SSL-сертификат

reg.ru предлагает несколько вариантов SSL:

1. **Бесплатный Let's Encrypt** (рекомендуется):
   - В панели управления выберите "SSL-сертификаты"
   - Закажите бесплатный сертификат Let's Encrypt
   - Подтвердите владение доменом

2. **Платный SSL-сертификат**:
   - Выберите подходящий сертификат
   - Пройдите процедуру подтверждения

## Настройка базы данных (для production)

Поскольку текущая версия использует хранение в памяти, для production рекомендуется настроить постоянное хранение:

### 1. MongoDB (рекомендуется)

1. Установите MongoDB на ваш VPS:
   ```bash
   # Добавьте репозиторий MongoDB
   wget -qO - https://www.mongodb.org/static/pgp/server-6.0.asc | apt-key add -
   echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse" | tee /etc/apt/sources.list.d/mongodb-org-6.0.list
   
   # Установите MongoDB
   apt update
   apt install -y mongodb-org
   
   # Запустите MongoDB
   systemctl start mongod
   systemctl enable mongod
   ```

2. Обновите приложение для использования MongoDB (потребуется изменение кода)

### 2. PostgreSQL

1. Установите PostgreSQL:
   ```bash
   apt install postgresql postgresql-contrib -y
   ```

2. Настройте базу данных и пользователя (потребуется изменение кода)

## Мониторинг и оптимизация

### 1. Мониторинг ресурсов

1. Используйте встроенные инструменты мониторинга reg.ru
2. Настройте оповещения о превышении использования ресурсов

### 2. Резервное копирование

1. Настройте автоматическое резервное копирование в панели reg.ru
2. Создайте собственный скрипт резервного копирования:

```bash
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/color360_$DATE"

# Создайте директорию для резервной копии
mkdir -p $BACKUP_DIR

# Скопируйте данные приложения
cp -r /opt/color360/data $BACKUP_DIR/
cp -r /opt/color360/pano/export $BACKUP_DIR/

# Создайте архив
tar -czf "/backup/color360_backup_$DATE.tar.gz" $BACKUP_DIR

# Удалите старые резервные копии
find /backup -name "color360_backup_*.tar.gz" -mtime +30 -delete
```

## Устранение неполадок

### Распространенные проблемы:

1. **Порт 80/443 недоступен**:
   - Проверьте настройки брандмауэра reg.ru
   - Убедитесь, что в настройках хостинга разрешен трафик на эти порты

2. **Домен не открывается**:
   - Проверьте DNS-записи в панели reg.ru
   - Дождитесь полного распространения DNS (до 24 часов)

3. **SSL-сертификат не устанавливается**:
   - Убедитесь, что домен правильно указывает на ваш сервер
   - Проверьте, что порт 80 доступен для подтверждения

4. **Недостаточно ресурсов**:
   - Перейдите на более высокий тарифный план
   - Оптимизируйте приложение

### Поддержка reg.ru

Если у вас возникнут проблемы с хостингом:
1. Обратитесь в техническую поддержку reg.ru через панель управления
2. Используйте чат поддержки на сайте reg.ru
3. Проверьте базу знаний reg.ru

## Дополнительные рекомендации

1. **CDN**: Используйте CDN reg.ru для ускорения загрузки статических файлов
2. **Кэширование**: Настройте кэширование Nginx для статических ресурсов
3. **Сжатие**: Включите Gzip сжатие для уменьшения объема передаваемых данных
4. **Безопасность**: Регулярно обновляйте систему и приложения
5. **Логирование**: Настройте логирование для мониторинга работы приложения

После выполнения этих шагов ваш сайт Color360 и редактор панорам будут доступны онлайн на хостинге reg.ru.