<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç–µ–π</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        background: #1a1a1a;
        color: white;
        padding: 20px;
        line-height: 1.6;
      }

      .test-section {
        background: #333;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
      }

      .status {
        padding: 10px;
        border-radius: 4px;
        margin: 10px 0;
      }

      .status.success {
        background: #004d00;
      }
      .status.error {
        background: #4d0000;
      }
      .status.warning {
        background: #4d4d00;
      }
      .status.info {
        background: #003d4d;
      }

      button {
        padding: 10px 20px;
        background: #0066cc;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
        font-size: 14px;
      }

      button:hover {
        background: #0055aa;
      }

      .log {
        background: #222;
        padding: 10px;
        border-radius: 4px;
        font-family: monospace;
        max-height: 300px;
        overflow-y: auto;
        font-size: 12px;
      }

      iframe {
        width: 100%;
        height: 500px;
        border: 1px solid #555;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <h1>üé¨ –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç–µ–π</h1>

    <div class="test-section">
      <h2>üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
      <div id="diagnostic-info"></div>
      <button onclick="runDiagnostics()">üîç –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É</button>
      <button onclick="openMainApp()">üöÄ –û—Ç–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
    </div>

    <div class="test-section">
      <h2>üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</h2>
      <div>
        <h3>–®–∞–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç–µ–π:</h3>
        <ol>
          <li>
            <strong>–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç–∏:</strong>
            <ul>
              <li>–ö–ª–∏–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –≤ –ø—É—Å—Ç–æ–º –º–µ—Å—Ç–µ –ø–∞–Ω–æ—Ä–∞–º—ã</li>
              <li>–í—ã–±–µ—Ä–∏—Ç–µ "–í–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç—å" –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é</li>
              <li>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å"</li>
            </ul>
          </li>
          <li>
            <strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è:</strong>
            <ul>
              <li>
                –ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é –∑–æ–Ω—É –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç–∏ (–∫—É—Ä—Å–æ—Ä –¥–æ–ª–∂–µ–Ω
                —Å—Ç–∞—Ç—å "move")
              </li>
              <li>–ó–∞–∂–º–∏—Ç–µ –ª–µ–≤—É—é –∫–Ω–æ–ø–∫—É –º—ã—à–∏ –∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç—å</li>
              <li>
                –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –∫—É—Ä—Å–æ—Ä–æ–º
              </li>
            </ul>
          </li>
          <li>
            <strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏:</strong>
            <ul>
              <li>–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç—å –Ω–∞ –Ω–æ–≤–æ–µ –º–µ—Å—Ç–æ</li>
              <li>–ü–æ–≤–µ—Ä–Ω–∏—Ç–µ –∫–∞–º–µ—Ä—É (–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ø–∞–Ω–æ—Ä–∞–º—É)</li>
              <li>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏–¥–µ–æ-–æ–±–ª–∞—Å—Ç—å –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —Å–≤–æ–µ–º –º–µ—Å—Ç–µ</li>
            </ul>
          </li>
          <li>
            <strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑—É–º–∞:</strong>
            <ul>
              <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–ª–µ—Å–∏–∫–æ –º—ã—à–∏ –¥–ª—è –∑—É–º–∞</li>
              <li>–ù–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ +/- –¥–ª—è –∑—É–º–∞</li>
              <li>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–Ω–æ—Ä–∞–º–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è/—É–º–µ–Ω—å—à–∞–µ—Ç—Å—è</li>
              <li>–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è "üîç 125%" –≤ —Ü–µ–Ω—Ç—Ä–µ —ç–∫—Ä–∞–Ω–∞</li>
            </ul>
          </li>
        </ol>
      </div>
    </div>

    <div class="test-section">
      <h2>üîß –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h2>
      <iframe id="app-frame" src="index.html"></iframe>
      <button onclick="reloadApp()">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
      <button onclick="openInNewTab()">üîó –û—Ç–∫—Ä—ã—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ</button>
    </div>

    <div class="test-section">
      <h2>üìã –ñ—É—Ä–Ω–∞–ª –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</h2>
      <div id="diagnostic-log" class="log"></div>
      <button onclick="clearLog()">üßπ –û—á–∏—Å—Ç–∏—Ç—å –∂—É—Ä–Ω–∞–ª</button>
    </div>

    <script>
      function log(message, type = "info") {
        const logElement = document.getElementById("diagnostic-log");
        const time = new Date().toLocaleTimeString();
        const colors = {
          success: "#4CAF50",
          error: "#f44336",
          warning: "#ff9800",
          info: "#2196F3",
        };

        logElement.innerHTML += `<div style="color: ${colors[type] || colors.info}">[${time}] ${message}</div>`;
        logElement.scrollTop = logElement.scrollHeight;
      }

      function clearLog() {
        document.getElementById("diagnostic-log").innerHTML = "";
      }

      function runDiagnostics() {
        const infoElement = document.getElementById("diagnostic-info");
        infoElement.innerHTML = "";

        log("üîç –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã...", "info");

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞
        const browserInfo = {
          userAgent: navigator.userAgent,
          language: navigator.language,
          platform: navigator.platform,
          cookieEnabled: navigator.cookieEnabled,
          onLine: navigator.onLine,
        };

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
        const features = {
          webGL: !!window.WebGLRenderingContext,
          webGL2: !!window.WebGL2RenderingContext,
          canvas: !!document.createElement("canvas").getContext,
          localStorage: !!window.localStorage,
          sessionStorage: !!window.sessionStorage,
          indexedDB: !!window.indexedDB,
          webRTC: !!window.RTCPeerConnection,
          fullscreen: !!document.fullscreenElement !== undefined,
        };

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ A-Frame
        const aframeStatus = {
          loaded: !!window.AFRAME,
          version: window.AFRAME ? window.AFRAME.version : "–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω",
        };

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        infoElement.innerHTML = `
                <div class="status info">
                    <strong>üåê –ë—Ä–∞—É–∑–µ—Ä:</strong> ${
                      browserInfo.userAgent.includes("Chrome")
                        ? "Chrome"
                        : browserInfo.userAgent.includes("Firefox")
                          ? "Firefox"
                          : browserInfo.userAgent.includes("Safari")
                            ? "Safari"
                            : "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π"
                    }
                </div>
                <div class="status ${features.webGL ? "success" : "error"}">
                    <strong>üéÆ WebGL:</strong> ${features.webGL ? "‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è" : "‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è"}
                </div>
                <div class="status ${features.localStorage ? "success" : "error"}">
                    <strong>üíæ LocalStorage:</strong> ${features.localStorage ? "‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω" : "‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω"}
                </div>
                <div class="status ${aframeStatus.loaded ? "success" : "warning"}">
                    <strong>üéØ A-Frame:</strong> ${aframeStatus.loaded ? `‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω (${aframeStatus.version})` : "‚ö†Ô∏è –ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω"}
                </div>
                <div class="status info">
                    <strong>üåç –°–µ—Ç—å:</strong> ${browserInfo.onLine ? "‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω" : "‚ùå –û—Ñ–ª–∞–π–Ω"}
                </div>
            `;

        log(`üåê –ë—Ä–∞—É–∑–µ—Ä: ${browserInfo.userAgent.split(" ")[0]}`, "info");
        log(
          `üéÆ WebGL: ${features.webGL ? "–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è" : "–ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è"}`,
          features.webGL ? "success" : "error"
        );
        log(
          `üíæ LocalStorage: ${features.localStorage ? "–¥–æ—Å—Ç—É–ø–µ–Ω" : "–Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"}`,
          features.localStorage ? "success" : "error"
        );
        log(
          `üéØ A-Frame: ${aframeStatus.loaded ? `–∑–∞–≥—Ä—É–∂–µ–Ω (${aframeStatus.version})` : "–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω"}`,
          aframeStatus.loaded ? "success" : "warning"
        );
        log("‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞", "success");
      }

      function openMainApp() {
        window.open("index.html", "_blank");
        log("üöÄ –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ", "info");
      }

      function reloadApp() {
        const frame = document.getElementById("app-frame");
        frame.src = frame.src;
        log("üîÑ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–æ", "info");
      }

      function openInNewTab() {
        window.open("index.html", "_blank");
        log("üîó –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ", "info");
      }

      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
      window.addEventListener("load", () => {
        log("üìã –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞", "success");
        setTimeout(runDiagnostics, 500);
      });

      // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç iframe
      window.addEventListener("message", (event) => {
        if (event.origin === window.location.origin) {
          log(`üì® –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: ${event.data}`, "info");
        }
      });
    </script>
  </body>
</html>
